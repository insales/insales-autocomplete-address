{"version":3,"file":"InsalesAutocompleteAdress.js","mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA,iEAAiE;AACjE;AACA,yDAAyD;AACzD;AACA,yDAAyD;AACzD;AACA,qDAAqD;AACrD;AACA;AACA;AACA,qDAAqD;AACrD;AACA,2DAA2D;AAC3D;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,QAAQ;AACrB,cAAc,QAAQ;AACtB,cAAc,QAAQ;AACtB;;AAEA;AACA,WAAW,QAAQ;AACnB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH,CAAC;AACD;AACA;AACA,mFAAmF;AACnF;AACA;AACA,yDAAyD;AACzD;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAEkC;;;;;;;;;;;;AC/gBnC;;;;;;;;;;;;;;;;ACAuD;AACF;AACJ;AACU;;;AAG3D;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,KAAK;AACL,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iDAAiD,SAAS;AAC1D;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI,4DAAY;AAChB;AACA;AACA;AACA,UAAU,4DAAY;AACtB;AACA,OAAO;AACP,KAAK;;AAEL;AACA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,aAAa;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,oCAAoC,mEAAY;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA,MAAM,oEAAY;AAClB;AACA;AACA,uBAAuB,0CAA0C;AACjE,YAAY;AACZ;AACA;AACA,SAAS;AACT;AACA;AACA,uBAAuB,0CAA0C;AACjE;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB,aAAa,QAAQ;AACrB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,eAAe,QAAQ;AACvB;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA,YAAY,uEAAe;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB,aAAa,QAAQ;AACrB;AACA;AACA;AACA,MAAM,4DAAY;AAClB;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,sBAAsB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+DAAe,0BAA0B,EAAC;;;;;;;;;;;;ACnN1C,+DAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH,IAAI,EAAC;;;;;;;;;;;;ACjBL,+DAAe;AACf;AACA,mCAAmC,YAAY;;AAE/C;AACA,CAAC;;;;;;;;;;;;;;ACLwC;AACI;;AAE7C,4BAA4B,8CAA8C;AAC1E;AACA;AACA;AACA,QAAQ,4DAAY;AACpB;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,WAAW;AACX,QAAQ;AACR;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,sCAAsC,WAAW,OAAO;AACxD;AACA;;AAEA;AACA;AACA,IAAI,2DAAU;AACd;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA,+DAAe,CAAC,yBAAyB;;;;;;;;;;;;;AC1EA;;AAEzC,+DAAe;AACf;AACA,iBAAiB,SAAS,0BAA0B,MAAM,WAAW,QAAQ;;AAE7E;AACA;AACA;AACA;;AAEA,IAAI,0DAAU;AACd;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH,CAAC;;;;;;;UC5BD;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA,8CAA8C;;;;;WCA9C;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;ACNkD;AACvB;;;AAG3B,+DAAe,+CAA0B,EAAC","sources":["webpack://InsalesAutocompleteAdress/./node_modules/@trevoreyre/autocomplete-js/dist/autocomplete.esm.js","webpack://InsalesAutocompleteAdress/./src/style/main.scss","webpack://InsalesAutocompleteAdress/./src/app.js","webpack://InsalesAutocompleteAdress/./src/modules/fetchJSONP.js","webpack://InsalesAutocompleteAdress/./src/modules/highlightResult.js","webpack://InsalesAutocompleteAdress/./src/modules/location.js","webpack://InsalesAutocompleteAdress/./src/modules/searchAction.js","webpack://InsalesAutocompleteAdress/webpack/bootstrap","webpack://InsalesAutocompleteAdress/webpack/runtime/define property getters","webpack://InsalesAutocompleteAdress/webpack/runtime/hasOwnProperty shorthand","webpack://InsalesAutocompleteAdress/webpack/runtime/make namespace object","webpack://InsalesAutocompleteAdress/./src/index.js"],"sourcesContent":["function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nfunction _defineProperty(e, r, t) {\n  return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == typeof i ? i : i + \"\";\n}\n\n// Polyfill for element.matches, to support Internet Explorer. It's a relatively\n// simple polyfill, so we'll just include it rather than require the user to\n// include the polyfill themselves. Adapted from\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill\nvar matches = function matches(element, selector) {\n  return element.matches ? element.matches(selector) : element.msMatchesSelector ? element.msMatchesSelector(selector) : element.webkitMatchesSelector ? element.webkitMatchesSelector(selector) : null;\n};\n\n// Polyfill for element.closest, to support Internet Explorer. It's a relatively\n// simple polyfill, so we'll just include it rather than require the user to\n// include the polyfill themselves. Adapted from\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill\nvar closestPolyfill = function closestPolyfill(el, selector) {\n  var element = el;\n  while (element && element.nodeType === 1) {\n    if (matches(element, selector)) {\n      return element;\n    }\n    element = element.parentNode;\n  }\n  return null;\n};\nvar closest = function closest(element, selector) {\n  return element.closest ? element.closest(selector) : closestPolyfill(element, selector);\n};\n\n// Returns true if the value has a \"then\" function. Adapted from\n// https://github.com/graphql/graphql-js/blob/499a75939f70c4863d44149371d6a99d57ff7c35/src/jsutils/isPromise.js\nvar isPromise = function isPromise(value) {\n  return Boolean(value && typeof value.then === 'function');\n};\n\nvar AutocompleteCore = /*#__PURE__*/_createClass(function AutocompleteCore() {\n  var _this = this;\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    search = _ref.search,\n    _ref$autoSelect = _ref.autoSelect,\n    autoSelect = _ref$autoSelect === void 0 ? false : _ref$autoSelect,\n    _ref$setValue = _ref.setValue,\n    setValue = _ref$setValue === void 0 ? function () {} : _ref$setValue,\n    _ref$setAttribute = _ref.setAttribute,\n    setAttribute = _ref$setAttribute === void 0 ? function () {} : _ref$setAttribute,\n    _ref$onUpdate = _ref.onUpdate,\n    onUpdate = _ref$onUpdate === void 0 ? function () {} : _ref$onUpdate,\n    _ref$onSubmit = _ref.onSubmit,\n    onSubmit = _ref$onSubmit === void 0 ? function () {} : _ref$onSubmit,\n    _ref$onShow = _ref.onShow,\n    onShow = _ref$onShow === void 0 ? function () {} : _ref$onShow,\n    _ref$autocorrect = _ref.autocorrect,\n    autocorrect = _ref$autocorrect === void 0 ? false : _ref$autocorrect,\n    _ref$onHide = _ref.onHide,\n    onHide = _ref$onHide === void 0 ? function () {} : _ref$onHide,\n    _ref$onLoading = _ref.onLoading,\n    onLoading = _ref$onLoading === void 0 ? function () {} : _ref$onLoading,\n    _ref$onLoaded = _ref.onLoaded,\n    onLoaded = _ref$onLoaded === void 0 ? function () {} : _ref$onLoaded,\n    _ref$submitOnEnter = _ref.submitOnEnter,\n    submitOnEnter = _ref$submitOnEnter === void 0 ? false : _ref$submitOnEnter;\n  _classCallCheck(this, AutocompleteCore);\n  _defineProperty(this, \"value\", '');\n  _defineProperty(this, \"searchCounter\", 0);\n  _defineProperty(this, \"results\", []);\n  _defineProperty(this, \"selectedIndex\", -1);\n  _defineProperty(this, \"selectedResult\", null);\n  _defineProperty(this, \"destroy\", function () {\n    _this.search = null;\n    _this.setValue = null;\n    _this.setAttribute = null;\n    _this.onUpdate = null;\n    _this.onSubmit = null;\n    _this.autocorrect = null;\n    _this.onShow = null;\n    _this.onHide = null;\n    _this.onLoading = null;\n    _this.onLoaded = null;\n  });\n  _defineProperty(this, \"handleInput\", function (event) {\n    var value = event.target.value;\n    _this.updateResults(value);\n    _this.value = value;\n  });\n  _defineProperty(this, \"handleKeyDown\", function (event) {\n    var key = event.key;\n    switch (key) {\n      case 'Up': // IE/Edge\n      case 'Down': // IE/Edge\n      case 'ArrowUp':\n      case 'ArrowDown':\n        {\n          var selectedIndex = key === 'ArrowUp' || key === 'Up' ? _this.selectedIndex - 1 : _this.selectedIndex + 1;\n          event.preventDefault();\n          _this.handleArrows(selectedIndex);\n          break;\n        }\n      case 'Tab':\n        {\n          _this.selectResult();\n          break;\n        }\n      case 'Enter':\n        {\n          var isListItemSelected = event.target.getAttribute('aria-activedescendant').length > 0;\n          _this.selectedResult = _this.results[_this.selectedIndex] || _this.selectedResult;\n          _this.selectResult();\n          if (_this.submitOnEnter) {\n            _this.selectedResult && _this.onSubmit(_this.selectedResult);\n          } else {\n            if (isListItemSelected) {\n              event.preventDefault();\n            } else {\n              _this.selectedResult && _this.onSubmit(_this.selectedResult);\n              _this.selectedResult = null;\n            }\n          }\n          break;\n        }\n      case 'Esc': // IE/Edge\n      case 'Escape':\n        {\n          _this.hideResults();\n          _this.setValue();\n          break;\n        }\n      default:\n        return;\n    }\n  });\n  _defineProperty(this, \"handleFocus\", function (event) {\n    var value = event.target.value;\n    _this.updateResults(value);\n    _this.value = value;\n  });\n  _defineProperty(this, \"handleBlur\", function () {\n    _this.hideResults();\n  });\n  // The mousedown event fires before the blur event. Calling preventDefault() when\n  // the results list is clicked will prevent it from taking focus, firing the\n  // blur event on the input element, and closing the results list before click fires.\n  _defineProperty(this, \"handleResultMouseDown\", function (event) {\n    event.preventDefault();\n  });\n  _defineProperty(this, \"handleResultClick\", function (event) {\n    var target = event.target;\n    var result = closest(target, '[data-result-index]');\n    if (result) {\n      _this.selectedIndex = parseInt(result.dataset.resultIndex, 10);\n      var selectedResult = _this.results[_this.selectedIndex];\n      _this.selectResult();\n      _this.onSubmit(selectedResult);\n    }\n  });\n  _defineProperty(this, \"handleArrows\", function (selectedIndex) {\n    // Loop selectedIndex back to first or last result if out of bounds\n    var resultsCount = _this.results.length;\n    _this.selectedIndex = (selectedIndex % resultsCount + resultsCount) % resultsCount;\n\n    // Update results and aria attributes\n    _this.onUpdate(_this.results, _this.selectedIndex);\n  });\n  _defineProperty(this, \"selectResult\", function () {\n    var selectedResult = _this.results[_this.selectedIndex];\n    if (selectedResult) {\n      _this.setValue(selectedResult);\n    }\n    _this.hideResults();\n  });\n  _defineProperty(this, \"updateResults\", function (value) {\n    var currentSearch = ++_this.searchCounter;\n    _this.onLoading();\n    _this.search(value).then(function (results) {\n      if (currentSearch !== _this.searchCounter) {\n        return;\n      }\n      _this.results = results;\n      _this.onLoaded();\n      if (_this.results.length === 0) {\n        _this.hideResults();\n        return;\n      }\n      _this.selectedIndex = _this.autoSelect ? 0 : -1;\n      _this.onUpdate(_this.results, _this.selectedIndex);\n      _this.showResults();\n    });\n  });\n  _defineProperty(this, \"showResults\", function () {\n    _this.setAttribute('aria-expanded', true);\n    _this.onShow();\n  });\n  _defineProperty(this, \"hideResults\", function () {\n    _this.selectedIndex = -1;\n    _this.results = [];\n    _this.setAttribute('aria-expanded', false);\n    _this.setAttribute('aria-activedescendant', '');\n    _this.onUpdate(_this.results, _this.selectedIndex);\n    _this.onHide();\n  });\n  // Make sure selected result isn't scrolled out of view\n  _defineProperty(this, \"checkSelectedResultVisible\", function (resultsElement) {\n    var selectedResultElement = resultsElement.querySelector(\"[data-result-index=\\\"\".concat(_this.selectedIndex, \"\\\"]\"));\n    if (!selectedResultElement) {\n      return;\n    }\n    var resultsPosition = resultsElement.getBoundingClientRect();\n    var selectedPosition = selectedResultElement.getBoundingClientRect();\n    if (selectedPosition.top < resultsPosition.top) {\n      // Element is above viewable area\n      resultsElement.scrollTop -= resultsPosition.top - selectedPosition.top;\n    } else if (selectedPosition.bottom > resultsPosition.bottom) {\n      // Element is below viewable area\n      resultsElement.scrollTop += selectedPosition.bottom - resultsPosition.bottom;\n    }\n  });\n  this.search = isPromise(search) ? search : function (value) {\n    return Promise.resolve(search(value));\n  };\n  this.autoSelect = autoSelect;\n  this.setValue = setValue;\n  this.setAttribute = setAttribute;\n  this.onUpdate = onUpdate;\n  this.onSubmit = onSubmit;\n  this.autocorrect = autocorrect;\n  this.onShow = onShow;\n  this.onHide = onHide;\n  this.onLoading = onLoading;\n  this.onLoaded = onLoaded;\n  this.submitOnEnter = submitOnEnter;\n});\n\n// Generates a unique ID, with optional prefix. Adapted from\n// https://github.com/lodash/lodash/blob/61acdd0c295e4447c9c10da04e287b1ebffe452c/uniqueId.js\nvar idCounter = 0;\nvar uniqueId = function uniqueId() {\n  var prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return \"\".concat(prefix).concat(++idCounter);\n};\n\n// Calculates whether element2 should be above or below element1. Always\n// places element2 below unless all of the following:\n// 1. There isn't enough visible viewport below to fit element2\n// 2. There is more room above element1 than there is below\n// 3. Placing elemen2 above 1 won't overflow window\nvar getRelativePosition = function getRelativePosition(element1, element2) {\n  var position1 = element1.getBoundingClientRect();\n  var position2 = element2.getBoundingClientRect();\n  var positionAbove = /* 1 */position1.bottom + position2.height > window.innerHeight && /* 2 */window.innerHeight - position1.bottom < position1.top && /* 3 */window.pageYOffset + position1.top - position2.height > 0;\n  return positionAbove ? 'above' : 'below';\n};\n\n// Credit David Walsh (https://davidwalsh.name/javascript-debounce-function)\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nvar debounce = function debounce(func, wait, immediate) {\n  var timeout;\n  return function executedFunction() {\n    var context = this;\n    var args = arguments;\n    var later = function later() {\n      timeout = null;\n      func.apply(context, args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\n/**\n * @typedef {Object} LabelObj\n * @property {string} attribute - `aria-label` | `aria-labelledby`\n * @property {string} content - content of attribute\n */\n\n/**\n * @param {string} labelStr - content for `aria-label` or – if it starts with `#` – ID for `aria-labelledby`\n * @returns {LabelObj} Object with label attribute and its content\n */\nvar getAriaLabel = function getAriaLabel(labelStr) {\n  if (labelStr !== null && labelStr !== void 0 && labelStr.length) {\n    var isLabelId = labelStr.startsWith('#');\n    return {\n      attribute: isLabelId ? 'aria-labelledby' : 'aria-label',\n      content: isLabelId ? labelStr.substring(1) : labelStr\n    };\n  }\n};\n\n// Creates a props object with overridden toString function. toString returns an attributes\n// string in the format: `key1=\"value1\" key2=\"value2\"` for easy use in an HTML string.\nvar Props = /*#__PURE__*/function () {\n  function Props(index, selectedIndex, baseClass) {\n    _classCallCheck(this, Props);\n    this.id = \"\".concat(baseClass, \"-result-\").concat(index);\n    this[\"class\"] = \"\".concat(baseClass, \"-result\");\n    this['data-result-index'] = index;\n    this.role = 'option';\n    if (index === selectedIndex) {\n      this['aria-selected'] = 'true';\n    }\n  }\n  return _createClass(Props, [{\n    key: \"toString\",\n    value: function toString() {\n      var _this = this;\n      return Object.keys(this).reduce(function (str, key) {\n        return \"\".concat(str, \" \").concat(key, \"=\\\"\").concat(_this[key], \"\\\"\");\n      }, '');\n    }\n  }]);\n}();\nvar Autocomplete = /*#__PURE__*/_createClass(function Autocomplete(root) {\n  var _this2 = this;\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n    search = _ref.search,\n    _ref$onSubmit = _ref.onSubmit,\n    onSubmit = _ref$onSubmit === void 0 ? function () {} : _ref$onSubmit,\n    _ref$onUpdate = _ref.onUpdate,\n    onUpdate = _ref$onUpdate === void 0 ? function () {} : _ref$onUpdate,\n    _ref$baseClass = _ref.baseClass,\n    baseClass = _ref$baseClass === void 0 ? 'autocomplete' : _ref$baseClass,\n    _ref$autocorrect = _ref.autocorrect,\n    autocorrect = _ref$autocorrect === void 0 ? false : _ref$autocorrect,\n    autoSelect = _ref.autoSelect,\n    _ref$getResultValue = _ref.getResultValue,\n    getResultValue = _ref$getResultValue === void 0 ? function (result) {\n      return result;\n    } : _ref$getResultValue,\n    renderResult = _ref.renderResult,\n    _ref$debounceTime = _ref.debounceTime,\n    debounceTime = _ref$debounceTime === void 0 ? 0 : _ref$debounceTime,\n    resultListLabel = _ref.resultListLabel,\n    _ref$submitOnEnter = _ref.submitOnEnter,\n    submitOnEnter = _ref$submitOnEnter === void 0 ? false : _ref$submitOnEnter;\n  _classCallCheck(this, Autocomplete);\n  _defineProperty(this, \"expanded\", false);\n  _defineProperty(this, \"loading\", false);\n  _defineProperty(this, \"position\", {});\n  _defineProperty(this, \"resetPosition\", true);\n  // Set up aria attributes and events\n  _defineProperty(this, \"initialize\", function () {\n    _this2.root.style.position = 'relative';\n    _this2.input.setAttribute('role', 'combobox');\n    _this2.input.setAttribute('autocomplete', 'off');\n    _this2.input.setAttribute('autocapitalize', 'off');\n    if (_this2.autocorrect) {\n      _this2.input.setAttribute('autocorrect', 'on');\n    }\n    _this2.input.setAttribute('spellcheck', 'false');\n    _this2.input.setAttribute('aria-autocomplete', 'list');\n    _this2.input.setAttribute('aria-haspopup', 'listbox');\n    _this2.input.setAttribute('aria-expanded', 'false');\n    _this2.resultList.setAttribute('role', 'listbox');\n    var resultListAriaLabel = getAriaLabel(_this2.resultListLabel);\n    resultListAriaLabel && _this2.resultList.setAttribute(resultListAriaLabel.attribute, resultListAriaLabel.content);\n    _this2.resultList.style.position = 'absolute';\n    _this2.resultList.style.zIndex = '1';\n    _this2.resultList.style.width = '100%';\n    _this2.resultList.style.boxSizing = 'border-box';\n\n    // Generate ID for results list if it doesn't have one\n    if (!_this2.resultList.id) {\n      _this2.resultList.id = uniqueId(\"\".concat(_this2.baseClass, \"-result-list-\"));\n    }\n    _this2.input.setAttribute('aria-owns', _this2.resultList.id);\n    document.body.addEventListener('click', _this2.handleDocumentClick);\n    _this2.input.addEventListener('input', _this2.core.handleInput);\n    _this2.input.addEventListener('keydown', _this2.core.handleKeyDown);\n    _this2.input.addEventListener('focus', _this2.core.handleFocus);\n    _this2.input.addEventListener('blur', _this2.core.handleBlur);\n    _this2.resultList.addEventListener('mousedown', _this2.core.handleResultMouseDown);\n    _this2.resultList.addEventListener('click', _this2.core.handleResultClick);\n    _this2.updateStyle();\n  });\n  _defineProperty(this, \"destroy\", function () {\n    document.body.removeEventListener('click', _this2.handleDocumentClick);\n    _this2.input.removeEventListener('input', _this2.core.handleInput);\n    _this2.input.removeEventListener('keydown', _this2.core.handleKeyDown);\n    _this2.input.removeEventListener('focus', _this2.core.handleFocus);\n    _this2.input.removeEventListener('blur', _this2.core.handleBlur);\n    _this2.resultList.removeEventListener('mousedown', _this2.core.handleResultMouseDown);\n    _this2.resultList.removeEventListener('click', _this2.core.handleResultClick);\n    _this2.root = null;\n    _this2.input = null;\n    _this2.resultList = null;\n    _this2.getResultValue = null;\n    _this2.onUpdate = null;\n    _this2.renderResult = null;\n    _this2.core.destroy();\n    _this2.core = null;\n  });\n  _defineProperty(this, \"setAttribute\", function (attribute, value) {\n    _this2.input.setAttribute(attribute, value);\n  });\n  _defineProperty(this, \"setValue\", function (result) {\n    _this2.input.value = result ? _this2.getResultValue(result) : '';\n  });\n  _defineProperty(this, \"renderResult\", function (result, props) {\n    return \"<li \".concat(props, \">\").concat(_this2.getResultValue(result), \"</li>\");\n  });\n  _defineProperty(this, \"handleUpdate\", function (results, selectedIndex) {\n    _this2.resultList.innerHTML = '';\n    results.forEach(function (result, index) {\n      var props = new Props(index, selectedIndex, _this2.baseClass);\n      var resultHTML = _this2.renderResult(result, props);\n      if (typeof resultHTML === 'string') {\n        _this2.resultList.insertAdjacentHTML('beforeend', resultHTML);\n      } else {\n        _this2.resultList.insertAdjacentElement('beforeend', resultHTML);\n      }\n    });\n    _this2.input.setAttribute('aria-activedescendant', selectedIndex > -1 ? \"\".concat(_this2.baseClass, \"-result-\").concat(selectedIndex) : '');\n    if (_this2.resetPosition) {\n      _this2.resetPosition = false;\n      _this2.position = getRelativePosition(_this2.input, _this2.resultList);\n      _this2.updateStyle();\n    }\n    _this2.core.checkSelectedResultVisible(_this2.resultList);\n    _this2.onUpdate(results, selectedIndex);\n  });\n  _defineProperty(this, \"handleShow\", function () {\n    _this2.expanded = true;\n    _this2.updateStyle();\n  });\n  _defineProperty(this, \"handleHide\", function () {\n    _this2.expanded = false;\n    _this2.resetPosition = true;\n    _this2.updateStyle();\n  });\n  _defineProperty(this, \"handleLoading\", function () {\n    _this2.loading = true;\n    _this2.updateStyle();\n  });\n  _defineProperty(this, \"handleLoaded\", function () {\n    _this2.loading = false;\n    _this2.updateStyle();\n  });\n  _defineProperty(this, \"handleDocumentClick\", function (event) {\n    if (_this2.root.contains(event.target)) {\n      return;\n    }\n    _this2.core.hideResults();\n  });\n  _defineProperty(this, \"updateStyle\", function () {\n    _this2.root.dataset.expanded = _this2.expanded;\n    _this2.root.dataset.loading = _this2.loading;\n    _this2.root.dataset.position = _this2.position;\n    _this2.resultList.style.visibility = _this2.expanded ? 'visible' : 'hidden';\n    _this2.resultList.style.pointerEvents = _this2.expanded ? 'auto' : 'none';\n    if (_this2.position === 'below') {\n      _this2.resultList.style.bottom = null;\n      _this2.resultList.style.top = '100%';\n    } else {\n      _this2.resultList.style.top = null;\n      _this2.resultList.style.bottom = '100%';\n    }\n  });\n  this.root = typeof root === 'string' ? document.querySelector(root) : root;\n  this.input = this.root.querySelector('input');\n  this.resultList = this.root.querySelector('ul');\n  this.baseClass = baseClass;\n  this.autocorrect = autocorrect;\n  this.getResultValue = getResultValue;\n  this.onUpdate = onUpdate;\n  if (typeof renderResult === 'function') {\n    this.renderResult = renderResult;\n  }\n  this.resultListLabel = resultListLabel;\n  this.submitOnEnter = submitOnEnter;\n  var core = new AutocompleteCore({\n    search: search,\n    autoSelect: autoSelect,\n    setValue: this.setValue,\n    setAttribute: this.setAttribute,\n    onUpdate: this.handleUpdate,\n    autocorrect: this.autocorrect,\n    onSubmit: onSubmit,\n    onShow: this.handleShow,\n    onHide: this.handleHide,\n    onLoading: this.handleLoading,\n    onLoaded: this.handleLoaded,\n    submitOnEnter: this.submitOnEnter\n  });\n  if (debounceTime > 0) {\n    core.handleInput = debounce(core.handleInput, debounceTime);\n  }\n  this.core = core;\n  this.initialize();\n});\n\nexport { Autocomplete as default };\n","// extracted by mini-css-extract-plugin\nexport {};","import Autocomplete from '@trevoreyre/autocomplete-js';\nimport searchAction from './modules/searchAction.js';\nimport locationUtil from './modules/location.js';\nimport highlightResult from './modules/highlightResult.js';\n\n\nclass InsalesAutocompleteAddress {\n  constructor(selector, {\n      onChange = () => {},\n      autoLocation = true,\n      initialFulltextSearch = null,\n      country = 'RU',\n      debounceTime = 0\n    }) {\n    this.options = {onChange, debounceTime, autoLocation, country, initialFulltextSearch};\n    this.originalSelector = selector;\n    this.items = document.querySelectorAll(selector);\n    this.storageKey = 'InsalesAutocompleteAddress';\n    this.currentLocation = '';\n    this.searchQuery = '';\n    this.AutocompleteInstance = null;\n    this.boundHandleLocationUpdate = this.handleLocationUpdate.bind(this);\n\n    if (!this.items.length) {\n      console.warn(`Передан неверный селектор: ${selector}`);\n      return;\n    }\n\n    this.init();\n  }\n\n  /**\n   * Инициализирует автокомплиты и обработчики событий\n   */\n  init() {\n    locationUtil.getLocation(this.storageKey, this.options).then((data) => {\n      this.items.forEach(el => {\n        this.createAutocomplete(el);\n        if (data) {\n          locationUtil.setLocation(this.storageKey, data);\n        }\n      });\n    });\n\n    document.addEventListener('update:location:insales:autocomplete:address', this.boundHandleLocationUpdate);\n  }\n\n  /**\n   * Устанавливает значение в поля ввода автокомплита\n   * @param {Object} data - Объект с данными о локации\n   * @param {string} data.result - Результат поиска для установки в поле ввода\n   */\n  setValue(data) {\n    this.items.forEach(el => {\n      const $input = el.querySelector('.insales-autocomplete-address-input');\n      if (data.result && $input && $input.value !== data.result) {\n        $input.value = data.result;\n        $input.setAttribute('value', data.result);\n      }\n    });\n  }\n\n  /**\n   * Устанавливает страну для поиска адресов\n   * @param {string} country - Код страны (например, 'RU', 'US', 'DE')\n   */\n  setCountry(country) {\n    this.options.country = country;\n  }\n\n  /**\n   * Создает экземпляр автокомплита для указанного элемента\n   * @param {HTMLElement} selector - DOM элемент контейнера автокомплита\n   */\n  createAutocomplete(selector) {\n    const options = this.options;\n    const $input = selector.querySelector('.insales-autocomplete-address-input');\n\n    if ($input) {\n      $input.onkeydown = (evt) => {\n        if (evt.key === 'Enter') {\n          evt.preventDefault();\n          evt.stopPropagation();\n          return false;\n        }\n      };\n    }\n\n    selector.classList.add('insales-autocomplete-address');\n\n    this.AutocompleteInstance = new Autocomplete(selector, {\n      search: this.handleSearch.bind(this),\n      baseClass: 'insales-autocomplete-address',\n      autoSelect: true,\n      debounceTime: options.debounceTime,\n      getResultValue: this.getResultValue.bind(this),\n      renderResult: this.renderResult.bind(this),\n      onSubmit: this.handleSubmit.bind(this)\n    });\n  }\n\n  /**\n   * Обрабатывает поисковый запрос пользователя\n   * @param {string} input - Поисковый запрос пользователя\n   * @returns {Promise<Array>} Промис, который разрешается массивом результатов поиска\n   */\n  handleSearch(input) {\n    this.searchQuery = input;\n    return new Promise((resolve) => {\n      searchAction(input, this.options.country)\n        .then((data) => {\n          if (data.length === 0 && input.length > 5) {\n            resolve([{ isError: true, result: 'Город не найден' }]);\n          } else {\n            resolve(data);\n          }\n        })\n        .catch(() => {\n          if (input !== '') {\n            resolve([{ isError: true, result: 'Город не найден' }]);\n          }\n        });\n    });\n  }\n\n  /**\n   * Извлекает значение для отображения из результата поиска\n   * @param {Object} result - Результат поиска\n   * @param {boolean} result.isError - Флаг ошибки\n   * @param {string} result.result - Текст результата\n   * @returns {string} Значение для отображения в поле ввода\n   */\n  getResultValue(result) {\n    return (!result.isError) ? result.result : this.currentLocation;\n  }\n\n  /**\n   * Рендерит HTML для элемента результата поиска\n   * @param {Object} result - Результат поиска\n   * @param {string} result.result - Текст результата\n   * @param {string} props - HTML атрибуты для элемента списка\n   * @returns {string} HTML строка для элемента результата\n   */\n  renderResult(result, props) {\n    return `\n      <li ${props}>\n        <div class=\"insales-autocomplete-address-title\">\n          ${highlightResult(result.result, this.searchQuery)}\n        </div>\n      </li>\n    `;\n  }\n\n  /**\n   * Обрабатывает выбор результата пользователем\n   * @param {Object} result - Выбранный результат\n   * @param {boolean} result.isError - Флаг ошибки\n   * @param {string} result.result - Текст результата\n   */\n  handleSubmit(result) {\n    if (result && !result.isError) {\n      locationUtil.setLocation(this.storageKey, result, this.$input);\n    }\n  }\n\n  /**\n   * Обработчик события обновления локации\n   * @param {Event} event - Событие с данными о локации\n   */\n  handleLocationUpdate(event) {\n    this.setValue(event.detail.data);\n    this.options.onChange(event.detail.data);\n    this.currentLocation = event.detail.data.result;\n  }\n\n  /**\n   * Уничтожает все экземпляры автокомплита\n   * Удаляет обработчики событий и очищает ссылки\n   */\n  destroy() {\n    if (this.AutocompleteInstance && typeof this.AutocompleteInstance.destroy === 'function') {\n      this.AutocompleteInstance.destroy();\n    }\n    \n    document.removeEventListener('update:location:insales:autocomplete:address', this.boundHandleLocationUpdate);\n    \n    this.AutocompleteInstance = null;\n    this.items = null;\n    this.currentLocation = '';\n    this.searchQuery = '';\n  }\n\n  /**\n   * Пересоздает все экземпляры автокомплита\n   * Полезно для обновления конфигурации или восстановления после destroy\n   */\n  recreate() {\n    this.destroy();\n    \n    this.items = document.querySelectorAll(this.originalSelector);\n    \n    if (!this.items.length) {\n      console.warn(`Не найдены элементы по селектору: ${this.originalSelector}`);\n      return;\n    }\n    \n    this.boundHandleLocationUpdate = this.handleLocationUpdate.bind(this);\n    this.init();\n  }\n}\n\nexport default InsalesAutocompleteAddress;\n","export default (unique => url =>\n  new Promise(rs => {\n    let script = document.createElement('script')\n    let name = \"_jsonp_\" + unique++\n\n    if (url.match(/\\?/)) url += \"&callback=\"+name\n    else url += \"?callback=\"+name\n\n    script.src = url\n    window[name] = json => {\n      rs(new Response(JSON.stringify(json)))\n      script.remove()\n      delete window[name]\n    }\n\n    document.body.appendChild(script)\n  })\n)(0);\n","export default (result, searchInput) => {\n  let replacment = '<strong>$1</strong>';\n  let regExpInput = new RegExp(`(${searchInput})`,\"gi\");\n\n  return result.replace(regExpInput, replacment)\n}\n","import fetchJSONP from './fetchJSONP.js';\nimport searchAction from './searchAction.js';\n\nconst getLocation = (key, { autoLocation, country, initialFulltextSearch }) => {\n  return new Promise((resolve) => {\n    if (!localStorage || (localStorage && !localStorage[key] && (autoLocation || initialFulltextSearch))) {\n      if (initialFulltextSearch) {\n        searchAction(initialFulltextSearch, country)\n          .then((data) => {\n            if (data.length === 0) {\n              resolve(null)\n            } else {\n              resolve(data[0]);\n            }\n          })\n          .catch(() => {\n            if (input !== '') {\n              resolve(null)\n            }\n          });\n      } else {\n        getKladrLocation()\n          .then(resolve)\n          .catch(() => resolve(null));\n      }\n    } else {\n      try {\n        const data = JSON.parse(localStorage[key]);\n        resolve(data);\n      } catch (err) {\n        resolve(null);\n      }\n    }\n  });\n};\n\nconst setLocation = (key, data) => {\n  setEventUpdate('update:location:insales:autocomplete:address', data);\n  return new Promise((resolve, reject) => {\n    if (!localStorage) {\n      resolve();\n    } else {\n      try {\n        localStorage[key] = JSON.stringify(data);\n        resolve();\n      } catch (err) {\n        reject(err);\n      }\n    }\n  });\n};\n\nlet setEventUpdate = (name, data) => {\n  var event = new CustomEvent(name, { 'detail': {data} });\n  document.dispatchEvent(event);\n}\n\nlet getKladrLocation = () => {\n  return new Promise((resolve, reject) => {\n    fetchJSONP('https://kladr.insales.ru/locate.json', {\n      mode: \"no-cors\",\n      method: \"GET\"\n    })\n    .then(response => response.json())\n    .then(data => {\n      resolve(data);\n    })\n    .catch((err) => {\n      console.warn(err);\n      reject(err);\n    })\n  })\n}\n\nexport default {getLocation, setLocation}\n","import fetchJSONP from './fetchJSONP.js';\n\nexport default (input, country) => {\n  const kladrUrl = 'https://kladr.insales.ru'\n  const url = `${kladrUrl}/fulltext_search.json?q=${input}&country=${country}&with_parent=1`\n\n  return new Promise((resolve, reject) => {\n    if (input.length < 2) {\n      return resolve([])\n    }\n\n    fetchJSONP(url, {\n      mode: \"no-cors\",\n      method: \"GET\"\n    })\n    .then(response => response.json())\n    .then(data => {\n      if (data.error) {\n        reject(data.error);\n      }else{\n        resolve(data);\n      }\n    })\n    .catch((err) => {\n      console.warn(err);\n      reject(err);\n    })\n  })\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import InsalesAutocompleteAddress from './app.js';\nimport './style/main.scss';\n\n\nexport default InsalesAutocompleteAddress;\n"],"names":[],"sourceRoot":""}